/*! *****************************************************************************
 * interactive-blocks.js v1.0.0
 * https://github.com/csc309-fall-2020/js-library-lanyanxi#readme
 * (c) 2020 Jimmy Lan
 * Released under the MIT License
 ***************************************************************************** */
var InteractiveBlocks=function(){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};function t(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return(n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function r(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}var s,a=function(e,t){if(e.length!==t.length)return!1;t.sort(),e.sort();for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},l=function(e){this.model=e},c=function(e){function n(t,n){var i=e.call(this,t)||this;return i.storage=n,i.save=function(e){i.storage.setItem(e,i.model.serialize())},i.read=function(e){var t=i.storage.getItem(e);if(!t)throw new Error("Cannot read from key name '"+e+"'.");i.model.deserialize(t)},i}return t(n,e),n}(l),u=function(e){var t=this;void 0===e&&(e={}),this.events=e,this.register=function(e,n){var i=t.events[e]||[];i.includes(n)||(i.push(n),t.events[e]=i)},this.unregister=function(e,n){var i=t.events[e];if(!i)throw new Error("Event type '"+e+"' is not registered.");t.events[e]=i.filter((function(e){return e!==n}))},this.trigger=function(e){for(var n,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];null===(n=t.events[e])||void 0===n||n.forEach((function(e){return e.apply(void 0,i)}))}},p=function(){function e(e,t){void 0===t&&(t=localStorage),this.attributes=e,this.events=new u,this.persistence=new c(this,t)}return Object.defineProperty(e.prototype,"get",{get:function(){return this.attributes.get},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getAll",{get:function(){return this.attributes.getAll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"on",{get:function(){return this.events.register},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unregister",{get:function(){return this.events.unregister},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this.events.trigger},enumerable:!1,configurable:!0}),e.prototype.save=function(e){if(!this.persistence)throw new Error("No persistence is specified for this model.");this.persistence.save(e),this.events.trigger("save")},e.prototype.read=function(e){if(!this.persistence)throw new Error("No persistence is specified for this model.");this.persistence.read(e),this.events.trigger("read")},e.prototype.set=function(e,t){this.attributes.set(e),this.events.trigger("change",e,t)},e.prototype.replace=function(e){this.attributes.replace(e),this.events.trigger("change")},e.prototype.serialize=function(){return JSON.stringify(this.attributes.getAll())},e.prototype.deserialize=function(e){try{this.replace(JSON.parse(e))}catch(t){throw new Error("Cannot deserialize from value "+e)}},e}(),h=function(e){var t=this;this.data=e,this.get=function(e){return t.data[e]},this.getAll=function(){return t.data},this.set=function(e){Object.assign(t.data,e)},this.replace=function(e){t.data=e}},d=function(){function e(e,t){this.elements=o(e),this.events=new u,t&&(this.persistence=new c(this,t))}return Object.defineProperty(e.prototype,"on",{get:function(){return this.events.register},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this.events.trigger},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this.elements[e]},e.prototype.getAll=function(){return o(this.elements)},e.prototype.set=function(e,t){var n=o(this.elements);this.elements[e]=t,this.events.trigger("change",n)},e.prototype.remove=function(e){var t=o(this.elements);return this.elements=this.elements.filter((function(t){return t!==e})),this.events.trigger("change",t),e},e.prototype.removeAt=function(e){var t=o(this.elements),n=this.elements.splice(e,1)[0];return this.events.trigger("change",t),n},e.prototype.replace=function(e){var t=o(this.elements);this.elements=o(e),this.events.trigger("change",t)},e.prototype.save=function(e){if(!this.persistence)throw new Error("No persistence is specified for this model.");this.persistence.save(e),this.events.trigger("save")},e.prototype.read=function(e){if(!this.persistence)throw new Error("No persistence is specified for this model.");this.persistence.read(e),this.events.trigger("read")},e.prototype.deserialize=function(e){var t;try{t=JSON.parse(e)}catch(t){throw new Error('Cannot parse from the parameter "raw". '+e)}if(this.elements.length!==t.length)throw new Error("Not Assignable: Read "+t.length+" entries from storage, but only "+this.elements.length+" elements exist in the current collection.");for(var n=0;n<this.elements.length;n++)this.elements[n].deserialize(t[n])},e.prototype.serialize=function(){for(var e=[],t=0,n=this.elements;t<n.length;t++){var i=n[t];e.push(i.serialize())}return JSON.stringify(e)},e}();!function(e){e.unanswered="unanswered",e.correct="correct",e.warning="warning"}(s||(s={}));var b=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateQuestionStatus=function(){return i(t,void 0,void 0,(function(){var e,t,n,i,o;return r(this,(function(r){switch(r.label){case 0:return[4,this.determineCorrectness()];case 1:if(n=r.sent(),i=this.getAll().worthPoints||1,"boolean"==typeof n)e=n,t=i;else{if(n>i)throw new Error("Question "+this.get("id")+": checkAnswer callback returns a number that is larger than the number of points this question is worth. checkAnswer: "+n+", worthPoints: "+i+".");t=n,e=n===i}return o=e?s.correct:s.warning,this.set({questionStatus:o,currentPoints:t},{shouldRerender:!1}),[2]}}))}))},t}return t(n,e),Object.defineProperty(n.prototype,"idWithPrefix",{get:function(){return"ib-question-"+this.get("id")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentPoints",{get:function(){var e=this.get("questionStatus"),t=this.getAll().worthPoints||1,n=this.getAll().partialPoints||0;return e===s.correct?t:n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldDisable",{get:function(){var e=this.get("questionStatus"),t=void 0!==e;return t=this.get("disableMultipleAttempts")?t&&e!==s.unanswered:t&&e===s.correct},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldShowEmptyError",{get:function(){var e=this.get("allowEmptyResponse"),t=this.isAnswered;return!e&&!t},enumerable:!1,configurable:!0}),n}(p),f=function(e){function n(t,n){var o=e.call(this,new h(t),n)||this;return o.extractCorrectSelectionsFromOptions=function(){return o.get("options").filter((function(e){return e.isAnswer})).map((function(e){return e.id}))},o.guessAllowMultipleSelect=function(){return!o.get("checkAnswer")&&1!==o.get("options").reduce((function(e,t){return t.isAnswer?e+1:e}),0)},o.determineCorrectness=function(){return i(o,void 0,void 0,(function(){var e,t,n;return r(this,(function(i){switch(i.label){case 0:return e=this.get("userSelections")||[],(t=this.get("checkAnswer"))?[4,t(e)]:[3,2];case 1:return[2,i.sent()];case 2:return n=this.extractCorrectSelectionsFromOptions(),[2,a(e,n)]}}))}))},o}return t(n,e),Object.defineProperty(n.prototype,"isAnswered",{get:function(){return 0!==(this.get("userSelections")||[]).length},enumerable:!1,configurable:!0}),n.parseOptions=function(e,t){return e.map((function(e,n){return{id:String(n),text:e,isAnswer:null==t?void 0:t.includes(n)}}))},n}(b),g=function(e){function n(t,n){var o=e.call(this,new h(t),n)||this;return o.validateAttributes=function(){var e=o.getAll(),t=e.acceptableAnswers,n=e.hintNumChars,i=e.checkAnswer;if(!t&&!i)throw new Error("FillBlanks must contain one of the attributes: 'acceptableAnswers' | 'checkAnswer'");if(void 0===t||i||t.length||console.warn("No answer to FillBlank question '"+o.get("id")+"' will be marked correct."),void 0!==n&&void 0!==t){if(!t.length)throw new Error("At lease one element in 'acceptableAnswers' of FillBlank question '"+o.get("id")+"' should exist.");var r=t[0].length;t.forEach((function(e){if(e.length!==r)throw new Error("If attribute 'hintNumChars' is provided and set to a number (or true), all answers in 'acceptableAnswers' must have the same length, or 'acceptableAnswers' should only contain one string.")})),o.set({hintNumChars:r},{shouldRerender:!1})}if(void 0!==i&&"boolean"==typeof n)throw new Error("FillBlanks '"+o.get("id")+"': When using 'hintNumChars' and a callback function to check answers, please pass in the number of characters to hint to 'hintNumChars' attribute.")},o.determineCorrectness=function(){return i(o,void 0,void 0,(function(){var e,t,n,i,o,s;return r(this,(function(r){switch(r.label){case 0:return e=this.get("userInput")||"",t=this.get("acceptableAnswers"),n=this.get("caseSensitive"),(i=this.get("checkAnswer"))?[4,i(e)]:[3,2];case 1:return[2,r.sent()];case 2:return o=t||[],s=e,n||(o.map((function(e){return e.toLowerCase()})),s=e.toLowerCase()),[2,o.includes(s)]}}))}))},o.validateAttributes(),o}return t(n,e),Object.defineProperty(n.prototype,"isAnswered",{get:function(){return 0!==(this.get("userInput")||"").length},enumerable:!1,configurable:!0}),n}(b),m=function(e){function i(t,i){var r=e.call(this,new h(function(e){if(Array.isArray(e.questionCollection)){var t=e.questionCollection,i=new d(t),r=n({},e);return delete r.questionCollection,n({questionCollection:i},r)}return e}(t)),i)||this;return r.unregisterChangeListeners=function(e){e.forEach((function(e){return e.unregister("change",r.handleQuestionElementChange)}))},r.registerChangeListeners=function(e){e.forEach((function(e){return e.on("change",r.handleQuestionElementChange)}))},r.watchForQuestionsChange=function(){var e=r.get("questionCollection"),t=e.getAll();r.registerChangeListeners(t),e.on("change",r.handleQuestionCollectionChange)},r.handleQuestionElementChange=function(e){var t=e,n=t.question,i=t.questionStatus,o=t.worthPoints,s=t.partialPoints;(n||i||o||s)&&r.trigger("question-change",e)},r.handleQuestionCollectionChange=function(e){var t=r.get("questionCollection").getAll(),n=e;r.unregisterChangeListeners(n),r.registerChangeListeners(t),r.trigger("change",{questionCollection:t})},r.watchForQuestionsChange(),r}return t(i,e),i.prototype.set=function(t,n){if(t.questionCollection){var i=this.get("questionCollection").getAll();this.unregisterChangeListeners(i)}e.prototype.set.call(this,t,n),t.questionCollection&&this.watchForQuestionsChange()},i.prototype.serialize=function(){var e=this.getAll();return delete e.questionCollection,JSON.stringify(e)},i.prototype.deserialize=function(e){var t;try{t=JSON.parse(e)}catch(t){throw new Error("Cannot deserialize from value "+e)}if(null==t?void 0:t.questions)throw new Error("Illegal questions attribute from "+e+". Questions attribute should not be serialized.");this.set(t)},Object.defineProperty(i.prototype,"idWithPrefix",{get:function(){var e=this.get("id");return e?"ib-points-"+e:""},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"idSelector",{get:function(){var e=this.get("id");return e?"#ib-points-"+e:""},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"totalWorthPoints",{get:function(){return this.get("questionCollection").getAll().reduce((function(e,t){return e+(t.get("worthPoints")||1)}),0)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"totalEarnedPoints",{get:function(){return this.get("questionCollection").getAll().reduce((function(e,t){return e+t.currentPoints}),0)},enumerable:!1,configurable:!0}),i}(p),v=Object.freeze({__proto__:null,MultipleChoice:f,FillBlanks:g,get QuestionStatus(){return s},Question:b,PointsPanel:m,Persistence:l,StoragePersistence:c,BlockModel:p,EventRegistry:u,AttributeRegistry:h,Collection:d}),y=function(){function e(e,t){var n=this;this.parent=e,this.model=t,this.components={},this.bindModel=function(){n.model.on("change",(function(e,t){if(t&&!t.shouldRerender)return;n.rerender(e)}))},this.bindEvents=function(e){var t=n.eventsMap(),i=function(n){if(!t.hasOwnProperty(n))throw new Error("Unexpected prototype change in eventsMap. Please always provide a callback function for each event descriptor!");var i=n.split(":"),r=i[0],o=i[1];if(!r||!o)throw new Error("Descriptor, or key of the eventsMap object, must be in the format 'selector:eventType'!");e.querySelectorAll(r).forEach((function(e){e.addEventListener(o,t[n])}))};for(var r in t)i(r)},this.mapComponents=function(e){var t=n.componentsMap();for(var i in t){if(!t.hasOwnProperty(i))throw new Error("Unexpected prototype change in componentsMap!");var r=t[i],o=e.querySelector(r);if(!o)throw new Error("Cannot find component using selector "+r+" when working with key name "+i+".");n.components[i]=o}},this.rerender=function(e){n.render()},this.render=function(e){void 0===e&&(e=!1),e||(n.parent.innerHTML=""),n.componentWillRender();var t=document.createElement("template");t.innerHTML=n.htmlStructure,n.bindEvents(t.content),n.mapComponents(t.content),n.bindComponents(),n.componentDidRender(),n.parent.appendChild(t.content)},this.bindModel()}return Object.defineProperty(e.prototype,"selectors",{get:function(){return{}},enumerable:!1,configurable:!0}),e.prototype.componentDidRender=function(){},e.prototype.componentWillRender=function(){},e.prototype.eventsMap=function(){return{}},e.prototype.componentsMap=function(){return{}},e.prototype.bindComponents=function(){},e}(),w=function(e,t){var n=this;this.parent=e,this.collection=t,this.render=function(e){void 0===e&&(e=!1),e||(n.parent.innerHTML="");for(var t=0,i=n.collection.getAll();t<i.length;t++){var r=i[t];n.appendComponent(r)}}},x=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._loading=!1,t.settings={checkAnswerButtonText:"Check Answer",hintButtonText:"Hint"},t.updateQuestionContainer=function(){var e=document.querySelector(t.selectors.statusDiv),n=document.querySelector(t.selectors.checkAnswerButton),i=document.querySelector(t.selectors.hintButton),r=document.querySelector(t.selectors.errorLabel),o=t.model.get("questionStatus")===s.correct?"correct":"warning",a=t.model.shouldDisable;e.classList.remove("correct","warning"),e.classList.add(o),n.disabled=a,i&&(i.disabled=a),r.classList.remove("visible")},t.showEmptyError=function(){var e=document.querySelector(t.selectors.errorLabel);e.classList.contains("visible")||e.classList.add("visible")},t.displayLoadingState=function(e){var n,i=document.querySelector(t.selectors.statusDiv);(n=i.classList).remove.apply(n,o(["loading"],Object.values(s))),t._loading=e,e?i.classList.add("loading"):i.classList.remove("loading")},t.handleCheckAnswerClick=function(){return i(t,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return this._loading?[2]:this.model.shouldShowEmptyError?[2,this.showEmptyError()]:(this.displayLoadingState(!0),[4,this.model.updateQuestionStatus()]);case 1:return e.sent(),this.displayLoadingState(!1),this.updateQuestionContainer(),this.onCheckAnswerClick(),[2]}}))}))},t.handleHintClick=function(){return i(t,void 0,void 0,(function(){var e,t;return r(this,(function(n){return e=this.model.get("hint"),t=this.model.get("isShowingHint"),document.querySelector(this.selectors.hintLabel).innerHTML=t?"":e,this.model.set({isShowingHint:!t},{shouldRerender:!1}),[2]}))}))},t}return t(n,e),Object.defineProperty(n.prototype,"selectors",{get:function(){return{childDiv:"#"+this.model.idWithPrefix+" .ib-question-child",statusDiv:"#"+this.model.idWithPrefix+" .ib-question-status",hintLabel:"#"+this.model.idWithPrefix+" .ib-question-hint",errorLabel:"#"+this.model.idWithPrefix+" .ib-question-error",checkAnswerButton:"#"+this.model.idWithPrefix+" .ib-question-right button.check-answer",hintButton:"#"+this.model.idWithPrefix+" .ib-question-right button.hint"}},enumerable:!1,configurable:!0}),n.prototype.eventsMap=function(){var e,t=this.selectors.hintButton;return(e={})[this.selectors.checkAnswerButton+":click"]=this.handleCheckAnswerClick,e[t+":click"]=this.handleHintClick,e},n.prototype.onCheckAnswerClick=function(){},Object.defineProperty(n.prototype,"htmlStructure",{get:function(){var e=this.settings,t=e.checkAnswerButtonText,n=e.hintButtonText,i=this.model.shouldDisable?"disabled":"",r=this.model.get("hint")||"",o=this.model.get("isShowingHint");return'\n      <div id="'+this.model.idWithPrefix+'" class="ib-question-container">\n        <div class="ib-question-left">\n          <div class="ib-question-status '+(this.model.get("questionStatus")||"")+'">\n            <div class="ib-status-container"></div>\n          </div>\n        </div>\n        <div class="ib-question-right">\n          <h3 class="ib-question-text">'+this.model.get("question")+'</h3>\n          <h4 class="ib-question-hint">'+(o?r:"")+'</h4>\n          <div class="ib-question-child"></div>\n          <div>\n            <button class="ib-btn primary check-answer" '+i+">"+t+"</button>\n            "+(r?'<button class="ib-btn hint" '+i+">"+n+"</button>":"")+'\n          </div>\n          <h4 class="ib-question-error">* Please provide a valid response to this question!</h4>\n        </div>\n      </div>\n    '},enumerable:!1,configurable:!0}),n}(y),k=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleOptionInputChange=function(){var e=document.querySelectorAll(t.selectors.optionInputs);if(!e)throw new Error("Incomplete rendering of checkboxes in OptionsForm component.");var n=[];e.forEach((function(e){e.checked&&n.push(e.value)})),t.model.set({userSelections:n},{shouldRerender:!1})},t}return t(n,e),Object.defineProperty(n.prototype,"selectors",{get:function(){return{optionInputs:"#"+this.model.idWithPrefix+" .ib-option-label input",optionLabels:"#"+this.model.idWithPrefix+" .ib-option-label"}},enumerable:!1,configurable:!0}),n.prototype.eventsMap=function(){return{".ib-option-label input:change":this.handleOptionInputChange}},Object.defineProperty(n.prototype,"htmlStructure",{get:function(){var e=this,t=this.model.get("userSelections")||[],n=this.model.get("allowMultipleSelect")||this.model.guessAllowMultipleSelect()?"checkbox":"radio",i=this.model.shouldDisable;return""+this.model.get("options").map((function(r){var o=r.id,s=r.text;return'<label class="ib-option-label '+(i?"disabled":"")+'">\n             <input type="'+n+'" value='+o+' name="'+e.model.get("id")+'" '+(t.includes(o)?"checked":"")+" "+(i?"disabled":"")+' />\n             <span class="ib-option-text">'+s+'</span>\n             <span class="ib-option-checkmark '+n+'"></span>\n           </label>'})).join("")},enumerable:!1,configurable:!0}),n}(y),q=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.bindComponents=function(){t.optionsForm=new k(t.components.optionsForm,t.model),t.optionsForm.render()},t.onCheckAnswerClick=function(){return i(t,void 0,void 0,(function(){var e,t,n;return r(this,(function(i){if(e=this.model.shouldDisable,!this.optionsForm)throw new Error("Cannot handle event because OptionsForm failed to render.");return t=document.querySelectorAll(this.optionsForm.selectors.optionInputs),n=document.querySelectorAll(this.optionsForm.selectors.optionLabels),e&&(t.forEach((function(e){return e.disabled=!0})),n.forEach((function(e){return e.classList.add("disabled")}))),[2]}))}))},t}return t(n,e),n.prototype.componentsMap=function(){return{optionsForm:this.selectors.childDiv}},n}(x),C=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleInputChange=function(){var e=document.querySelector(t.selectors.input).value||"";t.model.set({userInput:e},{shouldRerender:!1})},t}return t(n,e),Object.defineProperty(n.prototype,"selectors",{get:function(){return{input:"#"+this.model.idWithPrefix+" input.ib-fb-input"}},enumerable:!1,configurable:!0}),n.prototype.eventsMap=function(){var e;return(e={})[".ib-fb-input:input"]=this.handleInputChange,e},Object.defineProperty(n.prototype,"htmlStructure",{get:function(){var e,t=this.model.get("hintNumChars"),n="",i="";if(t){n='style="width: '+("calc(1.5ch * "+t+")")+"; background: "+("repeating-linear-gradient(90deg, dimgrey 0, dimgrey 1ch, transparent 0, transparent 1.5ch) 0 100%/ calc(1.5ch * "+t+" - 0.5ch) 2px no-repeat;")+';"',i='maxlength="'+t+'"',e="hint-num-chars"}else e="normal";return'\n      <input class="ib-fb-input '+e+'" '+n+" "+i+' value="'+(this.model.get("userInput")||"")+'" />\n    '},enumerable:!1,configurable:!0}),n}(y),P=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCheckAnswerClick=function(){return i(t,void 0,void 0,(function(){var e;return r(this,(function(t){if(e=this.model.shouldDisable,!this.stringInput)throw Error("Cannot handle event because StringInput failed to render.");return document.querySelector(this.stringInput.selectors.input).disabled=e,[2]}))}))},t}return t(n,e),n.prototype.componentsMap=function(){return{stringInput:this.selectors.childDiv}},n.prototype.bindComponents=function(){this.stringInput=new C(this.components.stringInput,this.model),this.stringInput.render()},n}(x),S=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.rerender=function(){document.querySelector(t.selectors.label).textContent=t.display},t}return t(n,e),Object.defineProperty(n.prototype,"selectors",{get:function(){return{label:this.model.idSelector+" .ib-points-score-label"}},enumerable:!1,configurable:!0}),n.prototype.componentDidRender=function(){this.model.on("question-change",this.rerender)},Object.defineProperty(n.prototype,"display",{get:function(){var e,t=this.model.get("displayPercentage"),n=this.model.totalWorthPoints,i=this.model.totalEarnedPoints;t?e=(i/n*100).toFixed(2)+" %":e=i+" / "+n;return e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"htmlStructure",{get:function(){return'\n      <div class="ib-points-label-panel">\n        <h5 class="ib-points-score-label">'+this.display+"</h5>\n      </div>\n    "},enumerable:!1,configurable:!0}),n}(y),A=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleQuestionChange=function(){t.render()},t.handleCloseButtonClick=function(){var e=document.querySelector(t.selectors.pointsList);e.classList.contains("visible")&&e.classList.remove("visible")},t.getListItem=function(e){var t=e.idWithPrefix,n=e.get("title"),i=e.get("question"),r=e.get("worthPoints"),o=e.currentPoints,s=0===o?null:o;return'\n      <div class="ib-question-list-item">\n        <p class="ib-question-list-item-title">'+(n||i)+'</p>\n        <div class="ib-question-list-item-panel">\n          <a href="#'+t+'" class="ib-btn primary">Go to question</a>\n          <p class="ib-question-score"><span class="score">'+(s||"")+"</span> / "+(r||1)+"</p>\n        </div>\n      </div>\n    "},t}return t(n,e),Object.defineProperty(n.prototype,"selectors",{get:function(){return{closeButton:this.model.idSelector+" .ib-question-list-header .ib-btn",pointsList:this.model.idSelector+" .ib-points.question"}},enumerable:!1,configurable:!0}),n.prototype.componentDidRender=function(){this.model.on("question-change",this.handleQuestionChange)},n.prototype.eventsMap=function(){var e;return(e={})[".ib-question-list-header .ib-btn:click"]=this.handleCloseButtonClick,e},Object.defineProperty(n.prototype,"htmlStructure",{get:function(){var e=this;return"\n      <div class=\"ib-points-question-panel\">\n        <div class=\"ib-question-list-header\">\n          <h3 class=\"ib-question-list-title\">Questions</h3>\n          <button class=\"ib-btn white icon\">\n            <img src=\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24'%3e %3cpath d='M0 0h24v24H0V0z' fill='none'/%3e %3cpath d='M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z' fill='white'/%3e%3c/svg%3e\" alt=\"close panel icon\" />\n          </button>\n        </div>\n        "+this.model.get("questionCollection").getAll().map((function(t){return e.getListItem(t)})).join("")+"\n      </div>\n    "},enumerable:!1,configurable:!0}),n}(y),O=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.rerender=function(){var e=t.model.totalEarnedPoints,n=t.model.totalWorthPoints,i=document.querySelector(t.selectors.root);e===n?i.classList.add("correct"):i.classList.remove("correct")},t.handleLabelClick=function(){var e=document.querySelector(t.selectors.pointsList);e.classList.contains("visible")||e.classList.add("visible")},t.bindComponents=function(){new S(t.components.pointsLabel,t.model).render(),new A(t.components.pointsList,t.model).render()},t}return t(n,e),Object.defineProperty(n.prototype,"selectors",{get:function(){return{root:this.model.idSelector+".ib-points-panel",pointsLabel:this.model.idSelector+" .ib-points.label",pointsList:this.model.idSelector+" .ib-points.question"}},enumerable:!1,configurable:!0}),n.prototype.componentDidRender=function(){var e=this;this.model.on("question-change",(function(){console.log("received question change event"),e.rerender()}))},n.prototype.eventsMap=function(){var e;return(e={})[this.selectors.pointsLabel+":click"]=this.handleLabelClick,e},n.prototype.componentsMap=function(){return{pointsLabel:this.selectors.pointsLabel,pointsList:this.selectors.pointsList}},Object.defineProperty(n.prototype,"htmlStructure",{get:function(){return"\n      <div "+(this.model.idWithPrefix?'id="'+this.model.idWithPrefix+'"':"")+' class="ib-points-panel">\n        <div class="ib-points label"></div>\n        <div class="ib-points question"></div>\n      </div>\n    '},enumerable:!1,configurable:!0}),n}(y),E=Object.freeze({__proto__:null,BlockComponent:y,CollectionComponent:w,MultipleChoiceComponent:q,OptionsForm:k,StringInput:C,FillBlanksComponent:P,PointsPanelComponent:O,PointsListComponent:A}),L=[],j=[];!function(e,t){if(e&&"undefined"!=typeof document){var n,i=!0===t.prepend?"prepend":"append",r=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(r){var s=L.indexOf(o);-1===s&&(s=L.push(o)-1,j[s]={}),n=j[s]&&j[s][i]?j[s][i]:j[s][i]=a()}else n=a();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function a(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),r=0;r<n.length;r++)e.setAttribute(n[r],t.attributes[n[r]]);var s="prepend"===i?"afterbegin":"beforeend";return o.insertAdjacentElement(s,e),e}}(':root{--primary-color:#2196f3;--secondary-color:#f57c00;--success-color:#36c247;--warning-color:#e05316;--font-family:"Roboto","Helvetica",sans-serif;--font-color:#000;--option-border:#e8ebed;--container-background:#f8f9fa;--textbox-border:#1c1c1c}.ib-question-container{display:flex;flex-direction:row;width:100%;transition:all .3s ease;box-sizing:border-box;font-family:var(--font-family);color:var(--font-color)}.ib-question-left{border-right:3px solid #fff;width:70px;display:flex;align-items:center;justify-content:center;border-top-left-radius:10px;border-bottom-left-radius:10px}.ib-question-left,.ib-question-right{background:var(--container-background)}.ib-question-right{flex:1;padding:24px;border-top-right-radius:10px;border-bottom-right-radius:10px}.ib-question-status{width:40px;height:40px;border-radius:50%;border:2px solid var(--option-border);background:#fff;position:relative;box-sizing:content-box;transition:border .3s ease;will-change:border}.loading.ib-question-status{animation:border-color-alter 1.5s ease-in-out infinite}@keyframes border-color-alter{0%{border-color:var(--option-border)}50%{border-color:var(--primary-color)}to{border-color:var(--option-border)}}.correct.ib-question-status{border-color:var(--success-color)}.warning.ib-question-status{border-color:var(--warning-color)}.ib-status-container{position:absolute;display:block;top:0;left:0;width:40px;height:40px;border-radius:50%;transition:background .3s ease-in-out;will-change:background}.correct .ib-status-container{background:var(--success-color)}.warning .ib-status-container{background:var(--warning-color)}.ib-status-container:after{position:absolute;display:block;content:"";box-sizing:content-box}.correct .ib-status-container:after{left:15px;top:7px;width:8px;height:18px;border:solid #fff;border-width:0 3px 3px 0;transform:rotate(40deg)}.warning .ib-status-container:after{left:8px;top:8px;width:24px;height:24px;background:#fff;border-radius:50%}.ib-question-right .ib-question-text{font-weight:400;line-height:1.5;margin:0 0 9px;color:inherit}.ib-question-right .ib-question-hint{font-style:italic;font-weight:400;margin:0 0 16px;color:inherit}.ib-question-error,.visible.ib-question-error{font-weight:400;color:var(--warning-color);margin:8px 0 0}.ib-question-error{display:none}.ib-question-error.visible{display:block}.ib-question-child{margin-bottom:18px}.ib-btn.check-answer{margin-right:8px}.ib-option-label{height:24px;user-select:none;position:relative;display:block;margin-bottom:12px;font-size:18px;padding-left:33px;cursor:pointer}.ib-option-label>.ib-option-text{height:24px;vertical-align:middle;color:inherit}.ib-option-label>input{position:absolute;height:0;width:0;opacity:0;cursor:pointer}.ib-option-label>.ib-option-checkmark{position:absolute;top:0;left:0;height:20px;width:20px;background:#fff;border:2px solid var(--option-border);transition:.3s;box-sizing:content-box}.ib-option-label>.checkbox.ib-option-checkmark{border-radius:0}.ib-option-label>.radio.ib-option-checkmark{border-radius:50%}.ib-option-label:hover>.ib-option-checkmark{background:#ccc}.ib-option-label.disabled>input:checked~.ib-option-checkmark,.ib-option-label input:checked~.ib-option-checkmark{background:var(--primary-color);border-color:var(--primary-color)}.ib-option-checkmark:after{position:absolute;display:none;content:"";box-sizing:content-box}.ib-option-label input:checked~.ib-option-checkmark:after{display:block}.ib-option-label>.checkbox.ib-option-checkmark:after{left:7px;top:3px;width:4px;height:9px;border:solid #fff;border-width:0 3px 3px 0;transform:rotate(40deg)}.ib-option-label>.radio.ib-option-checkmark:after{left:7px;top:7px;width:6px;height:6px;border-radius:50%;background:#fff}.ib-option-label.disabled,.ib-option-label.disabled>input{cursor:default}.ib-option-label.disabled>input~.ib-option-checkmark{background:var(--option-border)}.ib-fb-input{display:block;font-size:2.5ch;outline:none;width:calc(100% - 10px);padding:5px;box-sizing:border-box}.ib-fb-input.normal{border:1px solid #b5b5b5;border-radius:3px;transition:all .3s ease-in}.ib-fb-input.normal:focus,.ib-fb-input.normal:hover{border:1px solid var(--textbox-border)}.ib-fb-input.hint-num-chars{border:none;padding:0;font-size:3ch;letter-spacing:.5ch;font-family:droid sans mono,consolas,monospace}.ib-fb-input.hint-num-chars:focus{color:var(--primary-color)}.ib-points{position:fixed;top:90px;right:0;background-color:var(--secondary-color);color:#fff;border-top-left-radius:8px;border-bottom-left-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,.25),0 4px 8px 2px rgba(0,0,0,.12);font-weight:400;transition:background-color .3s ease-in-out;will-change:background-color}.correct .ib-points{background-color:var(--success-color)}.correct .ib-points .ib-question-list-item .ib-btn{color:var(--success-color)}.label.ib-points{height:60px;min-width:64px;z-index:5;padding:0 15px;cursor:pointer;box-sizing:border-box}.question.ib-points{width:600px;padding:16px;z-index:6;transform:translateX(690px);transition:transform .3s cubic-bezier(.5,0,1,.5);will-change:transform;box-sizing:border-box}@media only screen and (max-width:600px){.question.ib-points{width:100%;overflow-y:auto;top:0}}.question.visible.ib-points{transform:translateX(0);transition:transform .25s cubic-bezier(0,1,.3,1)}.ib-points-label-panel{justify-content:center;align-items:center}.ib-points-label-panel,.ib-points-question-panel{width:100%;height:100%;display:flex;font-family:var(--font-family)}.ib-points-question-panel{flex-direction:column;align-items:flex-start}.ib-points-score-label{font-size:16px;margin:0;line-height:1.2}.ib-question-list-header{width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.ib-question-list-header .ib-question-list-title{margin:0;font-weight:400}.ib-question-list-header .icon.ib-btn{width:48px;height:48px}.ib-question-list-item{width:100%;display:flex;justify-content:space-between;align-items:center}@media only screen and (max-width:600px){.ib-question-list-item{flex-direction:column;align-items:flex-end}}.ib-question-list-item-title{margin-right:24px;color:inherit}.ib-question-list-item-panel{display:flex;justify-content:flex-end;align-items:center;box-sizing:border-box}.ib-question-list-item-panel .ib-btn{position:relative;white-space:nowrap;box-sizing:border-box}.ib-points-panel .ib-question-list-item-panel .ib-btn{background-color:#efefef;color:var(--secondary-color);font-weight:bolder}.ib-question-list-item-panel p.ib-question-score{min-height:36px;padding:5px 8px 4px;margin:0 0 0 10px;border-radius:4px;background-color:hsla(0,0%,100%,.3);text-align:right;min-width:69px;box-sizing:border-box;color:inherit}.ib-btn{border:none;padding:8px 24px;text-align:center;text-decoration:none;outline:none;display:inline-block;font-size:16px;cursor:pointer;transition:all .2s ease;border-radius:3px;box-sizing:border-box;font-family:var(--font-family)}.ib-btn.primary{box-shadow:0 1px 4px rgba(0,0,0,.3);background-color:var(--primary-color);color:#fff}.ib-btn.primary:hover{-webkit-filter:grayscale(20%);-moz-filter:grayscale(20%);filter:grayscale(20%);box-shadow:0 2px 5px rgba(0,0,0,.5)}.ib-btn.primary:active{-webkit-filter:grayscale(30%);-moz-filter:grayscale(30%);filter:grayscale(30%);box-shadow:0 1px 1px rgba(0,0,0,.1)}.ib-btn:hover{filter:brightness(90%)}.ib-btn:active{filter:brightness(75%)}.ib-btn.primary:disabled:hover,.ib-btn:disabled{cursor:default;-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%);filter:grayscale(100%);box-shadow:none}.ib-btn .icon{height:90%;width:90%}.icon.ib-btn{padding:8px;display:flex;align-items:center;justify-content:center;background-color:transparent;border-radius:50%}.icon.ib-btn:hover{filter:none}.white.icon.ib-btn:hover{background:hsla(0,0%,100%,.15)}.icon.ib-btn:active{filter:none}.white.icon.ib-btn:active{background:hsla(0,0%,100%,.25)}',{container:"head",singleTag:!0,prepend:!0});var z=n(n({},v),E);return window.Blocks=z,z}();
//# sourceMappingURL=interactive-blocks.min.js.map
